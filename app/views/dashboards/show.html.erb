<div class="p-4 md:p-8 bg-gray-50 min-h-screen">
  <div class="flex flex-col md:flex-row justify-between items-center mb-8 bg-white p-6 rounded-2xl shadow-sm border border-gray-100">
    <div class="flex items-center space-x-6">
      <h1 class="text-3xl font-black text-slate-800 tracking-tighter">配神</h1>
      <div class="flex items-center bg-gray-100 rounded-lg p-1">
        <%= link_to dashboard_path(date: @start_date - 7.days), class: "px-3 py-1 hover:bg-white rounded-md transition" do %>←<% end %>
        <span class="px-4 font-bold text-slate-700">
          <%= @start_date.strftime("%Y年%m月%d日") %> 〜 <%= @end_date.strftime("%m/%d") %>
        </span>
        <%= link_to dashboard_path(date: @start_date + 7.days), class: "px-3 py-1 hover:bg-white rounded-md transition" do %>→<% end %>
      </div>

      <%# --- ボタン3兄弟 UI調整版：間隔を20pxに固定 --- %>
      <div class="flex items-center ml-4" style="gap: 20px;">
        <%# 1. 今週 %>
        <%= link_to "今週", dashboard_path(date: Date.today.beginning_of_week),
            class: "px-4 py-2 bg-white border border-gray-300 rounded-xl text-sm font-bold shadow-sm hover:bg-gray-50 transition whitespace-nowrap" %>

        <%# 2. 前週の情報を引き継ぐ：内側paddingを確保(px-6) %>
        <%= button_to copy_pre_week_schedules_path(target_date: @start_date),
            method: :post,
            data: { turbo_confirm: "表示されている週の予定を一度リセットして、前週のデータをコピーします。よろしいですか？" },
            class: "px-6 py-2 bg-indigo-600 text-white rounded-xl text-sm font-bold shadow-md hover:bg-indigo-700 transition cursor-pointer whitespace-nowrap" do %>
          前週の情報を引き継ぐ
        <% end %>

        <%# 3. リセット %>
        <%= button_to reset_week_schedules_path(target_date: @start_date),
            method: :delete,
            data: { turbo_confirm: "表示されている週の予定（メンバー・車両・メモ）をすべて消去します。本当によろしいですか？" },
            class: "px-6 py-2 bg-white border border-red-200 text-red-500 rounded-xl text-sm font-bold shadow-sm hover:bg-red-50 transition cursor-pointer whitespace-nowrap" do %>
          リセット
        <% end %>
      </div>
    </div>

    <%= link_to weekly_report_dashboard_path(date: @start_date), class: "px-6 py-3 bg-indigo-600 text-white rounded-xl font-bold hover:bg-indigo-700 shadow-lg shadow-indigo-200" do %>
      印刷用ページを表示
    <% end %>
  </div>

  <%# --- 以下、テーブル部分は変更なし --- %>
  <div class="bg-white rounded-3xl shadow-xl border border-gray-200 overflow-hidden">
    <div class="overflow-x-auto">
      <table class="w-full border-collapse">
        <thead>
          <tr class="bg-slate-800 text-white">
            <th class="p-6 text-left font-black text-lg min-w-[200px] sticky left-0 bg-slate-800 z-20">現場 / 日付</th>
            <% @dates.each do |date| %>
              <th class="p-4 text-center min-w-[160px] border-l border-slate-700 <%= 'bg-indigo-900' if date == Date.today %>">
                <div class="text-xs opacity-60"><%= %w(日 月 火 水 木 金 土)[date.wday] %></div>
                <div class="text-lg font-black"><%= date.strftime("%m/%d") %></div>
              </th>
            <% end %>
          </tr>
        </thead>
        <tbody>
          <% @sites.each do |site| %>
            <tr class="border-b border-gray-100">
              <td class="p-4 font-black text-slate-700 sticky left-0 bg-white z-10 border-r shadow-sm">
                <%= site.name %>
              </td>
              <% @dates.each do |date| %>
                <td id="cell_<%= site.id %>" class="p-2 align-top h-[320px] border-r border-gray-50">
                  <% schedule = @schedules.find { |s| s.date == date && s.site_id == site.id } %>
                  <%= render "dashboards/placement_cell", site: site, date: date, schedule: schedule %>
                </td>
              <% end %>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>
</div>
