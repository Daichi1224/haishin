<div class="max-w-md mx-auto mt-10 p-6 bg-white rounded-2xl shadow-sm border border-gray-100">
  <h1 class="text-2xl font-black text-slate-800 mb-6 text-center">プロフィール編集</h1>

  <%= form_with model: @user, local: true, class: "space-y-6" do |f| %>

    <%# --- 基本情報 --- %>
    <div class="space-y-4">
      <div>
        <%= f.label :name, "お名前（表示名）", class: "block text-sm font-bold text-gray-700 mb-1" %>
        <%= f.text_field :name, required: true,
            oninvalid: "this.setCustomValidity('このフィールドを入力してください')",
            oninput: "this.setCustomValidity('')",
            class: "w-full p-3 px-4 border border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500" %>
      </div>

      <div>
        <%= f.label :email, "ログイン用ID", class: "block text-sm font-bold text-gray-700 mb-1" %>
        <%# email_field から text_field に変更して @ 制限を解除 %>
        <%= f.text_field :email, required: true,
            oninvalid: "this.setCustomValidity('このフィールドを入力してください')",
            oninput: "this.setCustomValidity('')",
            class: "w-full p-3 px-4 border border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500" %>
      </div>
    </div>

    <%# --- パスワード変更（任意） --- %>
    <div class="pt-6 border-t border-gray-50">
      <h2 class="text-sm font-bold text-gray-400 mb-4 uppercase tracking-wider text-center">パスワード変更（変更時のみ）</h2>

      <div class="space-y-4">
        <div>
          <%= f.label :password, "新しいパスワード", class: "block text-sm font-bold text-gray-700 mb-1" %>
          <%= f.password_field :password, placeholder: "6文字以上",
              minlength: 6,
              oninvalid: "this.setCustomValidity(this.value.length < 6 ? 'パスワード は6文字以上で入力してください' : '')",
              oninput: "this.setCustomValidity('')",
              class: "w-full p-3 px-4 border border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500" %>
        </div>

        <div>
          <%= f.label :password_confirmation, "パスワード（確認用）", class: "block text-sm font-bold text-gray-700 mb-1" %>
          <%# パスワード一致チェック用のスクリプトを追加 %>
          <%= f.password_field :password_confirmation,
              oninput: "this.setCustomValidity(this.value !== document.getElementById('user_password').value ? 'パスワード（確認用） が一致しません' : '')",
              class: "w-full p-3 px-4 border border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500" %>
        </div>
      </div>
    </div>

    <%# --- アクションボタン --- %>
    <div class="pt-6 space-y-3">
      <%= f.submit "変更を保存", class: "w-full py-4 bg-indigo-600 text-white font-black rounded-xl hover:bg-indigo-700 shadow-lg shadow-indigo-100 transition cursor-pointer" %>
      <%= link_to "キャンセルして戻る", root_path, class: "block text-center py-2 text-sm text-gray-400 font-bold hover:text-gray-600 transition" %>
    </div>
  <% end %>

  <%# --- 危険ゾーン（変更なし） --- %>
  <div class="mt-12 pt-6 border-t border-red-50 text-center">
    <p class="text-[10px] font-bold text-red-300 mb-2 uppercase tracking-widest">DANGER ZONE</p>

    <%= button_to user_path(@user),
        method: :delete,
        class: "w-full py-2 text-xs text-red-400 border border-red-100 rounded-lg hover:bg-red-50 hover:text-red-600 transition font-bold",
        form: {
          data: {
            turbo_confirm: "⚠️【最終確認：この操作は2度と取り消せません！】\n\n本当にアカウントを削除しますか？\n作成した全ての現場・メンバー・車両データが完全に消去されます。"
          }
        } do %>
      アカウントを完全に削除
    <% end %>
  </div>
</div>
